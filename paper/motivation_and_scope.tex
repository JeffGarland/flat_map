\section{Motivation and Scope}

There has been a strong desire for a more space- and/or runtime-efficient
representation for \code{map} among C++ users for some time now.  This has
motivated discussions among the members of SG14 resulting in a
paper\footnote{See P0038R0,
  \href{http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/p0038r0.html}{here}.},
numerous articles and talks, and an implementation in Boost,
\code{boost::container::flat_map}\footnote{Part of Boost.Container,
  \href{http://www.boost.org/doc/libs/1_61_0/doc/html/container.html}{here}.}.
Virtually everyone who makes games, embedded, or system software in C++ uses
the Boost implementation or one that they rolled themselves.\\

Here are some numbers that show why.  The graphs that follow show runtimes for
different \code{map}-like associative containers.  The containers used are
Boost.FlatMap, \code{map}, \code{unordered_map}, and two thin wrappers over a
sorted \code{vector}.  The ``custom pair'' version of the sorted \code{vector}
uses a simple \code{struct} instead of \code{pair} for its value type.  All
containers use either \code{<int, int>} or \code{<std::string, std::string>}
for the value type.\\

All data in the graphs below were produced on Windows with MSVC 2015, on Linux
with Clang 3.8 and libc++, or on Linux with g++ 4.8.4 and libstdc++.\\

Each set of six graphs shows the performance of a single operation on all
map-variants.  The left column shows the \code{<int, int>} runs, and the right
column shows the \code{<std::string, std::string>} ones.  Each row shows one
platform/compiler configuration. \\

These four sets of graphs cover the most commonly-used operations.  The first
set shows insertion of N elements with random keys; the second shows full
iteration across all N elements; the third shows \code{map.find()} called once
for each key used in the original insertions; and the fourth shows erasure of
all N elements, by the keys used in the original insertions.

\begin{tikzpicture}
    \begin{groupplot}[group style={group size=2 by 3, group name=myplot}, width=3.25in]


    \nextgroupplot[
        title={<int, int> Elements},
        xlabel=\empty,
        ylabel={Windows/MSVC 2015},
        xmin=0, xmax=262144,
        ymin=0, ymax=20000.0,
        xtick={8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768,65536,131072,262144,524288},
        xticklabels={8,,,,,,,,,,,,,,128k,256k,512k},
        ytick={0.0,10000.0,20000.0,30000.0},
        ymajorgrids=true,
        grid style=dashed,
        scaled x ticks=false,
        scaled y ticks=true,
        ]

    \addplot[color=blue,mark=|,no markers,]
        coordinates {(8,0.0010818)(16,0.0015626)(32,0.002644)(64,0.0079324)(128,0.0230756)(256,0.0365362)(512,0.100958)(1024,0.296925)(2048,0.919678)(4096,2.89767)(8192,12.0676)(16384,45.8741)(32768,178.203)(65536,668.505)(131072,2780.32)(262144,11046.4)};
        \label{plots:plot0}

    \addplot[color=red,mark=|,no markers,]
        coordinates {(8,0.0008416)(16,0.0025844)(32,0.0041468)(64,0.0114184)(128,0.0207928)(256,0.0601536)(512,0.0811882)(1024,0.189416)(2048,0.369449)(4096,0.804112)(8192,1.85162)(16384,3.84722)(32768,8.41945)(65536,18.2901)(131072,41.8174)(262144,102.855)};
        \label{plots:plot1}

    \addplot[color=brown,mark=|,no markers,]
        coordinates {(8,0.000601)(16,0.0025244)(32,0.0050478)(64,0.0092546)(128,0.018449)(256,0.0347334)(512,0.060636)(1024,0.123009)(2048,0.271205)(4096,0.519696)(8192,1.11704)(16384,2.21969)(32768,5.05251)(65536,9.48435)(131072,20.334)(262144,47.6272)};
        \label{plots:plot2}

    \addplot[color=green,mark=|,no markers,]
        coordinates {(8,0.0009616)(16,0.0022236)(32,0.0036656)(64,0.0073914)(128,0.0185098)(256,0.035336)(512,0.087376)(1024,0.374202)(2048,0.878692)(4096,3.10752)(8192,13.4935)(16384,47.1324)(32768,169.182)(65536,687.849)(131072,2779.52)(262144,11136.9)};
        \label{plots:plot3}

    \addplot[color=black,mark=|,no markers,]
        coordinates {(8,0.0009612)(16,0.0019834)(32,0.0037858)(64,0.0069102)(128,0.0139424)(256,0.0347328)(512,0.0978314)(1024,0.160753)(2048,0.422404)(4096,1.18872)(8192,5.36237)(16384,15.3698)(32768,56.2146)(65536,242.662)(131072,1021.61)(262144,4126.13)};
        \label{plots:plot4}

    \coordinate (top) at (rel axis cs:0,1);% coordinate at top of the first plot


    \nextgroupplot[
        title={<string, string> Elements},
        xlabel=\empty,
        ylabel=\empty,
        xmin=0, xmax=262144,
        ymin=0, ymax=300000.0,
        xtick={8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768,65536,131072,262144,524288},
        xticklabels={8,,,,,,,,,,,,,,128k,256k,512k},
        ytick={0.0,100000.0,200000.0,300000.0,400000.0},
        ymajorgrids=true,
        grid style=dashed,
        scaled x ticks=false,
        scaled y ticks=true,
        ]

    \addplot[color=blue,mark=|,no markers,]
        coordinates {(8,0.0030048)(16,0.0080524)(32,0.0163452)(64,0.0334122)(128,0.0892988)(256,0.247647)(512,0.952484)(1024,3.67667)(2048,13.1946)(4096,51.6375)(8192,212.977)(16384,856.467)(32768,3407.57)(65536,13309)(131072,54257.6)(262144,215915)};
        \label{plots:plot0}

    \addplot[color=red,mark=|,no markers,]
        coordinates {(8,0.0015024)(16,0.005168)(32,0.0078726)(64,0.025239)(128,0.0263816)(256,0.0589528)(512,0.121629)(1024,0.259187)(2048,0.556407)(4096,1.19646)(8192,2.70885)(16384,5.91881)(32768,12.7774)(65536,27.7913)(131072,77.936)(262144,148.329)};
        \label{plots:plot1}

    \addplot[color=brown,mark=|,no markers,]
        coordinates {(8,0.0017424)(16,0.005949)(32,0.0048082)(64,0.0099756)(128,0.0200708)(256,0.0399618)(512,0.0774612)(1024,0.161236)(2048,0.338938)(4096,0.717575)(8192,1.58138)(16384,3.29255)(32768,6.6747)(65536,13.8875)(131072,36.6764)(262144,66.082)};
        \label{plots:plot2}

    \addplot[color=green,mark=|,no markers,]
        coordinates {(8,0.0034258)(16,0.0080524)(32,0.0117178)(64,0.0397232)(128,0.0842512)(256,0.456053)(512,1.66827)(1024,3.55022)(2048,13.3123)(4096,53.2404)(8192,213.235)(16384,839.413)(32768,3372.01)(65536,13438.4)(131072,54618.9)(262144,214338)};
        \label{plots:plot3}

    \addplot[color=black,mark=|,no markers,]
        coordinates {(8,0.0022234)(16,0.0068514)(32,0.0115974)(64,0.0382194)(128,0.0811894)(256,0.279313)(512,0.936027)(1024,3.55468)(2048,13.5675)(4096,51.2762)(8192,213.113)(16384,841.446)(32768,3377.04)(65536,13359.1)(131072,54503.4)(262144,214233)};
        \label{plots:plot4}


    \nextgroupplot[
        title=\empty,
        xlabel=\empty,
        ylabel={Linux/Clang 3.8},
        xmin=0, xmax=16384,
        ymin=0, ymax=200.0,
        xtick={8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768},
        xticklabels={8,,,,,,,,,,,,},
        ytick={0.0,100.0,200.0,300.0},
        ymajorgrids=true,
        grid style=dashed,
        scaled x ticks=false,
        scaled y ticks=true,
        ]

    \addplot[color=blue,mark=|,no markers,]
        coordinates {(8,0.0051682)(16,0.0103366)(32,0.0195552)(64,0.0381328)(128,0.0774684)(256,0.159712)(512,0.352436)(1024,0.877671)(2048,2.29799)(4096,11.7495)(8192,53.9833)(16384,196.448)};
        \label{plots:plot0}

    \addplot[color=red,mark=|,no markers,]
        coordinates {(8,0.0049026)(16,0.0098618)(32,0.0193316)(64,0.0381472)(128,0.0755124)(256,0.16575)(512,0.314213)(1024,0.766604)(2048,1.34756)(4096,3.13117)(8192,6.17872)(16384,12.6943)};
        \label{plots:plot1}

    \addplot[color=brown,mark=|,no markers,]
        coordinates {(8,0.0060628)(16,0.011007)(32,0.0213284)(64,0.0414992)(128,0.081603)(256,0.267787)(512,0.46282)(1024,0.735791)(2048,1.77535)(4096,3.49727)(8192,6.87083)(16384,13.6288)};
        \label{plots:plot2}

    \addplot[color=green,mark=|,no markers,]
        coordinates {(8,0.0050706)(16,0.0098472)(32,0.0188574)(64,0.0383984)(128,0.0759856)(256,0.165171)(512,0.344054)(1024,0.865813)(2048,3.28058)(4096,11.6805)(8192,54.2499)(16384,196.588)};
        \label{plots:plot3}

    \addplot[color=black,mark=|,no markers,]
        coordinates {(8,0.004889)(16,0.009806)(32,0.0188428)(64,0.0373374)(128,0.074955)(256,0.154618)(512,0.310866)(1024,0.814979)(2048,1.94596)(4096,4.70239)(8192,15.426)(16384,79.2837)};
        \label{plots:plot4}


    \nextgroupplot[
        title=\empty,
        xlabel=\empty,
        ylabel=\empty,
        xmin=0, xmax=16384,
        ymin=0, ymax=2000.0,
        xtick={8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768},
        xticklabels={8,,,,,,,,,,,,},
        ytick={0.0,1000.0,2000.0,3000.0},
        ymajorgrids=true,
        grid style=dashed,
        scaled x ticks=false,
        scaled y ticks=true,
        ]

    \addplot[color=blue,mark=|,no markers,]
        coordinates {(8,0.008395)(16,0.0170128)(32,0.0375324)(64,0.0860034)(128,0.238438)(256,0.833318)(512,3.46777)(1024,12.227)(2048,41.0353)(4096,138.535)(8192,497.819)(16384,1868.14)};
        \label{plots:plot0}

    \addplot[color=red,mark=|,no markers,]
        coordinates {(8,0.0065226)(16,0.013382)(32,0.0274324)(64,0.0568512)(128,0.119194)(256,0.250253)(512,0.562218)(1024,1.23669)(2048,1.85724)(4096,5.3828)(8192,11.712)(16384,24.7115)};
        \label{plots:plot1}

    \addplot[color=brown,mark=|,no markers,]
        coordinates {(8,0.0080318)(16,0.0167338)(32,0.0322658)(64,0.065512)(128,0.138157)(256,0.278538)(512,0.554051)(1024,1.1529)(2048,2.23975)(4096,3.89718)(8192,8.881)(16384,18.088)};
        \label{plots:plot2}

    \addplot[color=green,mark=|,no markers,]
        coordinates {(8,0.0074456)(16,0.0161756)(32,0.0424764)(64,0.0847448)(128,0.232808)(256,0.869983)(512,3.7102)(1024,12.2279)(2048,41.1152)(4096,138.597)(8192,500.857)(16384,1753.32)};
        \label{plots:plot3}

    \addplot[color=black,mark=|,no markers,]
        coordinates {(8,0.0071376)(16,0.0155612)(32,0.0356752)(64,0.0837964)(128,0.277632)(256,0.839266)(512,3.46018)(1024,12.2553)(2048,41.0326)(4096,138.477)(8192,497.257)(16384,1868.33)};
        \label{plots:plot4}


    \nextgroupplot[
        title=\empty,
        xlabel={N},
        ylabel={Linux/GCC 4.8.4},
        xmin=0, xmax=16384,
        ymin=0, ymax=90.0,
        xtick={8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768},
        xticklabels={8,,,,,,,,,,,,},
        ytick={0.0,10.0,20.0,30.0,40.0,50.0,60.0,70.0,80.0,90.0,100.0},
        ymajorgrids=true,
        grid style=dashed,
        scaled x ticks=false,
        scaled y ticks=true,
        ]

    \addplot[color=blue,mark=|,no markers,]
        coordinates {(8,0.0058254)(16,0.0105184)(32,0.0207974)(64,0.0396982)(128,0.0768536)(256,0.157394)(512,0.329579)(1024,0.74383)(2048,1.80803)(4096,4.88952)(8192,15.7751)(16384,75.8362)};
        \label{plots:plot0}

    \addplot[color=red,mark=|,no markers,]
        coordinates {(8,0.0058662)(16,0.011469)(32,0.0204356)(64,0.040703)(128,0.0791736)(256,0.155858)(512,0.312235)(1024,0.624101)(2048,1.29279)(4096,2.52753)(8192,5.12744)(16384,10.2646)};
        \label{plots:plot1}

    \addplot[color=brown,mark=|,no markers,]
        coordinates {(8,0.0059084)(16,0.0123904)(32,0.0214414)(64,0.0426586)(128,0.0815454)(256,0.157032)(512,0.319008)(1024,0.638657)(2048,1.30234)(4096,2.55571)(8192,5.10088)(16384,10.2703)};
        \label{plots:plot2}

    \addplot[color=green,mark=|,no markers,]
        coordinates {(8,0.0055596)(16,0.010559)(32,0.019109)(64,0.0394174)(128,0.0772598)(256,0.159782)(512,0.330857)(1024,0.752148)(2048,1.88687)(4096,5.09475)(8192,17.1082)(16384,82.0665)};
        \label{plots:plot3}

    \addplot[color=black,mark=|,no markers,]
        coordinates {(8,0.0054064)(16,0.0106576)(32,0.0192062)(64,0.0384818)(128,0.0748854)(256,0.150203)(512,0.306951)(1024,0.632339)(2048,1.35599)(4096,3.02391)(8192,7.93802)(16384,24.5008)};
        \label{plots:plot4}


    \nextgroupplot[
        title=\empty,
        xlabel={N},
        ylabel=\empty,
        xmin=0, xmax=16384,
        ymin=0, ymax=600.0,
        xtick={8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768},
        xticklabels={8,,,,,,,,,,,,},
        ytick={0.0,100.0,200.0,300.0,400.0,500.0,600.0,700.0},
        ymajorgrids=true,
        grid style=dashed,
        scaled x ticks=false,
        scaled y ticks=true,
        ]

    \addplot[color=blue,mark=|,no markers,]
        coordinates {(8,0.0052402)(16,0.0106994)(32,0.0217656)(64,0.047213)(128,0.112556)(256,0.276053)(512,0.761119)(1024,2.48337)(2048,11.5062)(4096,42.3264)(8192,152.772)(16384,571.596)};
        \label{plots:plot0}

    \addplot[color=red,mark=|,no markers,]
        coordinates {(8,0.0055312)(16,0.0107586)(32,0.0215126)(64,0.0431198)(128,0.0881378)(256,0.18515)(512,0.389214)(1024,0.806491)(2048,1.63775)(4096,3.44311)(8192,7.19106)(16384,15.152)};
        \label{plots:plot1}

    \addplot[color=brown,mark=|,no markers,]
        coordinates {(8,0.005238)(16,0.0100298)(32,0.0199462)(64,0.0394344)(128,0.0805828)(256,0.159781)(512,0.320142)(1024,0.65078)(2048,1.3038)(4096,2.67089)(8192,5.28646)(16384,10.6409)};
        \label{plots:plot2}

    \addplot[color=green,mark=|,no markers,]
        coordinates {(8,0.0053204)(16,0.0107134)(32,0.0217752)(64,0.0463884)(128,0.106145)(256,0.258058)(512,0.698464)(1024,2.08528)(2048,9.75615)(4096,38.1169)(8192,142.008)(16384,538.376)};
        \label{plots:plot3}

    \addplot[color=black,mark=|,no markers,]
        coordinates {(8,0.0052638)(16,0.0105934)(32,0.0211174)(64,0.0458858)(128,0.106435)(256,0.25348)(512,0.689941)(1024,2.07442)(2048,9.72303)(4096,38.0368)(8192,142.082)(16384,541.678)};
        \label{plots:plot4}

    \coordinate (bot) at (rel axis cs:1,0);% coordinate at bottom of the last plot

    \end{groupplot}

    \path (myplot c1r1.outer north west)% plot in column 1 row 1
          -- node[anchor=south,rotate=90] {Time [milliseconds]}% label midway
          (myplot c1r3.outer south west);% plot in column 1 row 3

    % legend
    \path (myplot c1r3.south west|-current bounding box.south)--
      coordinate(legendpos)
      (myplot c2r3.south east|-current bounding box.south);
    \matrix[
        matrix of nodes,
        anchor=south,
        draw,
        inner sep=0.2em,
        draw
      ]at([yshift=-5ex]legendpos)
      {
        \ref{plots:plot0}& Boost.FlatMap&[5pt]
        \ref{plots:plot1}& std::map&[5pt]
        \ref{plots:plot2}& std::unordered\_map&[5pt]
        \ref{plots:plot3}& std::vector&[5pt]
        \ref{plots:plot4}& std::vector (custom pair)&[5pt]\\
      };

\end{tikzpicture}
\\
\\


Unsurprisingly, insertion takes longer in contiguous-storage implementations.
Boost.FlatMap and a sorted \code{vector<pair<int, int>>} have the steepest
growth curves.  The curve for sorted \code{vector} using a custom
\code{struct} is dramatically flatter in its growth in the \code{<int, int>}
runs.  Note that the custom-pair vector does about the same as the
\code{vector} of \code{pair} in the \code{<std::string, std::string>} runs.

\begin{tikzpicture}
    \begin{groupplot}[group style={group size=2 by 3, group name=myplot}, width=3.25in]


    \nextgroupplot[
        title={<int, int> Elements},
        xlabel=\empty,
        ylabel={Windows/MSVC 2015},
        xmin=0, xmax=262144,
        ymin=0, ymax=20.0,
        xtick={8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768,65536,131072,262144,524288},
        xticklabels={8,,,,,,,,,,,,,,128k,256k,512k},
        ytick={0.0,10.0,20.0,30.0},
        ymajorgrids=true,
        grid style=dashed,
        scaled x ticks=false,
        scaled y ticks=true,
        ]

    \addplot[color=blue,mark=|,no markers,]
        coordinates {(8,0)(16,0)(32,0)(64,0.0001202)(128,0.0001802)(256,0.0003004)(512,0.0003608)(1024,0.000721)(2048,0.0016224)(4096,0.0033652)(8192,0.0115378)(16384,0.0148432)(32768,0.0437486)(65536,0.0596128)(131072,0.131124)(262144,0.370118)};
        \label{plots:plot0}

    \addplot[color=red,mark=|,no markers,]
        coordinates {(8,0)(16,0.00018)(32,0.0002402)(64,0.0004804)(128,0.0009014)(256,0.0014422)(512,0.0033652)(1024,0.0084132)(2048,0.0245788)(4096,0.0552262)(8192,0.146629)(16384,0.577622)(32768,0.807121)(65536,1.85955)(131072,4.05399)(262144,11.0305)};
        \label{plots:plot1}

    \addplot[color=brown,mark=|,no markers,]
        coordinates {(8,0)(16,0)(32,0.00012)(64,0.00024)(128,0.0003004)(256,0.0007812)(512,0.0042064)(1024,0.003786)(2048,0.0093146)(4096,0.0305878)(8192,0.0977126)(16384,0.235869)(32768,0.626479)(65536,1.42218)(131072,3.12338)(262144,7.15141)};
        \label{plots:plot2}

    \addplot[color=green,mark=|,no markers,]
        coordinates {(8,6e-05)(16,0)(32,0)(64,0)(128,0.00012)(256,0.0001804)(512,0.00012)(1024,0.0006612)(2048,0.0012622)(4096,0.0028848)(8192,0.006971)(16384,0.0125596)(32768,0.0224148)(65536,0.0573892)(131072,0.104744)(262144,0.223188)};
        \label{plots:plot3}

    \addplot[color=black,mark=|,no markers,]
        coordinates {(8,0)(16,0)(32,0)(64,6.02e-05)(128,0)(256,0.0001804)(512,0.0003008)(1024,0.0004206)(2048,0.0009018)(4096,0.0019832)(8192,0.0102158)(16384,0.0114178)(32768,0.0201914)(65536,0.0566084)(131072,0.0932656)(262144,0.187613)};
        \label{plots:plot4}

    \coordinate (top) at (rel axis cs:0,1);% coordinate at top of the first plot


    \nextgroupplot[
        title={<string, string> Elements},
        xlabel=\empty,
        ylabel=\empty,
        xmin=0, xmax=262144,
        ymin=0, ymax=30.0,
        xtick={8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768,65536,131072,262144,524288},
        xticklabels={8,,,,,,,,,,,,,,128k,256k,512k},
        ytick={0.0,10.0,20.0,30.0,40.0},
        ymajorgrids=true,
        grid style=dashed,
        scaled x ticks=false,
        scaled y ticks=true,
        ]

    \addplot[color=blue,mark=|,no markers,]
        coordinates {(8,0.0001804)(16,0.000481)(32,0.000601)(64,0.0011418)(128,0.0015022)(256,0.0030048)(512,0.0060696)(1024,0.012139)(2048,0.023677)(4096,0.0507194)(8192,0.10234)(16384,0.208826)(32768,0.432376)(65536,0.874126)(131072,1.94734)(262144,3.9201)};
        \label{plots:plot0}

    \addplot[color=red,mark=|,no markers,]
        coordinates {(8,0.0002404)(16,0.000601)(32,0.0007212)(64,0.001262)(128,0.0023438)(256,0.004868)(512,0.010216)(1024,0.0281842)(2048,0.054385)(4096,0.13413)(8192,0.35846)(16384,0.849126)(32768,1.7771)(65536,4.01295)(131072,10.1204)(262144,21.3312)};
        \label{plots:plot1}

    \addplot[color=brown,mark=|,no markers,]
        coordinates {(8,0.0003)(16,0.000541)(32,0.0004806)(64,0.0009016)(128,0.0016228)(256,0.0034854)(512,0.0067908)(1024,0.0144226)(2048,0.0388804)(4096,0.0954888)(8192,0.271324)(16384,0.619868)(32768,1.30542)(65536,2.74749)(131072,6.04941)(262144,12.841)};
        \label{plots:plot2}

    \addplot[color=green,mark=|,no markers,]
        coordinates {(8,0.0002404)(16,0.0003606)(32,0.0004808)(64,0.000781)(128,0.0015628)(256,0.0048074)(512,0.0099154)(1024,0.0124396)(2048,0.023737)(4096,0.047955)(8192,0.100778)(16384,0.20498)(32768,0.39704)(65536,0.896661)(131072,1.98706)(262144,3.92034)};
        \label{plots:plot3}

    \addplot[color=black,mark=|,no markers,]
        coordinates {(8,0.0001802)(16,0.0002408)(32,0.0005408)(64,0.0009016)(128,0.0015622)(256,0.0031246)(512,0.0060694)(1024,0.012199)(2048,0.023617)(4096,0.0479548)(8192,0.0984938)(16384,0.196747)(32768,0.387966)(65536,0.912766)(131072,1.97408)(262144,3.92671)};
        \label{plots:plot4}


    \nextgroupplot[
        title=\empty,
        xlabel=\empty,
        ylabel={Linux/Clang 3.8},
        xmin=0, xmax=16384,
        ymin=0, ymax=1.0,
        xtick={8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768},
        xticklabels={8,,,,,,,,,,,,},
        ytick={0.0,1.0,2.0},
        ymajorgrids=true,
        grid style=dashed,
        scaled x ticks=false,
        scaled y ticks=true,
        ]

    \addplot[color=blue,mark=|,no markers,]
        coordinates {(8,0.0006844)(16,0.000559)(32,0.0006848)(64,0.0005868)(128,0.000601)(256,0.0006566)(512,0.000866)(1024,0.0010612)(2048,0.0019136)(4096,0.0050284)(8192,0.01767)(16384,0.026358)};
        \label{plots:plot0}

    \addplot[color=red,mark=|,no markers,]
        coordinates {(8,0.000559)(16,0.0007124)(32,0.000824)(64,0.0009778)(128,0.0012016)(256,0.002626)(512,0.0068442)(1024,0.0189268)(2048,0.0506492)(4096,0.14791)(8192,0.360884)(16384,0.880726)};
        \label{plots:plot1}

    \addplot[color=brown,mark=|,no markers,]
        coordinates {(8,0.0006564)(16,0.0006706)(32,0.0006006)(64,0.0008376)(128,0.0009776)(256,0.0032544)(512,0.0033664)(1024,0.0138986)(2048,0.0314146)(4096,0.0860166)(8192,0.166502)(16384,0.434622)};
        \label{plots:plot2}

    \addplot[color=green,mark=|,no markers,]
        coordinates {(8,0.000559)(16,0.0006706)(32,0.0006564)(64,0.0006708)(128,0.000824)(256,0.0007682)(512,0.000894)(1024,0.0011032)(2048,0.0027934)(4096,0.0081994)(8192,0.0178514)(16384,0.0321552)};
        \label{plots:plot3}

    \addplot[color=black,mark=|,no markers,]
        coordinates {(8,0.0006708)(16,0.0006706)(32,0.0007686)(64,0.000824)(128,0.0006008)(256,0.0006986)(512,0.0007684)(1024,0.0017878)(2048,0.0028354)(4096,0.006733)(8192,0.0172926)(16384,0.0266932)};
        \label{plots:plot4}


    \nextgroupplot[
        title=\empty,
        xlabel=\empty,
        ylabel=\empty,
        xmin=0, xmax=16384,
        ymin=0, ymax=2.0,
        xtick={8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768},
        xticklabels={8,,,,,,,,,,,,},
        ytick={0.0,1.0,2.0,3.0},
        ymajorgrids=true,
        grid style=dashed,
        scaled x ticks=false,
        scaled y ticks=true,
        ]

    \addplot[color=blue,mark=|,no markers,]
        coordinates {(8,0.0008104)(16,0.00095)(32,0.0011036)(64,0.0016202)(128,0.002612)(256,0.0045816)(512,0.0134794)(1024,0.0221398)(2048,0.0394884)(4096,0.07128)(8192,0.147267)(16384,0.278331)};
        \label{plots:plot0}

    \addplot[color=red,mark=|,no markers,]
        coordinates {(8,0.0007824)(16,0.0009218)(32,0.0012572)(64,0.0022072)(128,0.0040648)(256,0.015435)(512,0.0273778)(1024,0.0543784)(2048,0.0635834)(4096,0.264294)(8192,0.522329)(16384,1.38287)};
        \label{plots:plot1}

    \addplot[color=brown,mark=|,no markers,]
        coordinates {(8,0.0007822)(16,0.0009078)(32,0.0012016)(64,0.001802)(128,0.0031986)(256,0.0147508)(512,0.0185218)(1024,0.0323086)(2048,0.056627)(4096,0.102303)(8192,0.289702)(16384,0.676217)};
        \label{plots:plot2}

    \addplot[color=green,mark=|,no markers,]
        coordinates {(8,0.000838)(16,0.000908)(32,0.0011592)(64,0.0016622)(128,0.0025702)(256,0.0046794)(512,0.0151276)(1024,0.0245704)(2048,0.039991)(4096,0.0713358)(8192,0.140158)(16384,0.280539)};
        \label{plots:plot3}

    \addplot[color=black,mark=|,no markers,]
        coordinates {(8,0.0008104)(16,0.0009638)(32,0.0011316)(64,0.0016064)(128,0.002654)(256,0.0046654)(512,0.0169018)(1024,0.024291)(2048,0.0402566)(4096,0.0714056)(8192,0.138886)(16384,0.283263)};
        \label{plots:plot4}


    \nextgroupplot[
        title=\empty,
        xlabel={N},
        ylabel={Linux/GCC 4.8.4},
        xmin=0, xmax=16384,
        ymin=0, ymax=1.0,
        xtick={8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768},
        xticklabels={8,,,,,,,,,,,,},
        ytick={0.0,1.0,2.0},
        ymajorgrids=true,
        grid style=dashed,
        scaled x ticks=false,
        scaled y ticks=true,
        ]

    \addplot[color=blue,mark=|,no markers,]
        coordinates {(8,0.000726)(16,0.0007262)(32,0.0007404)(64,0.0006144)(128,0.000601)(256,0.0006148)(512,0.0008102)(1024,0.0007826)(2048,0.0011592)(4096,0.0019278)(8192,0.0033384)(16384,0.0131162)};
        \label{plots:plot0}

    \addplot[color=red,mark=|,no markers,]
        coordinates {(8,0.000629)(16,0.0007826)(32,0.000838)(64,0.0010898)(128,0.0012708)(256,0.0024726)(512,0.0050428)(1024,0.017796)(2048,0.0287324)(4096,0.0741718)(8192,0.204356)(16384,0.430809)};
        \label{plots:plot1}

    \addplot[color=brown,mark=|,no markers,]
        coordinates {(8,0.0007126)(16,0.0007268)(32,0.000712)(64,0.0008938)(128,0.0010052)(256,0.0016624)(512,0.0028356)(1024,0.0109236)(2048,0.021553)(4096,0.0375466)(8192,0.0924562)(16384,0.228702)};
        \label{plots:plot2}

    \addplot[color=green,mark=|,no markers,]
        coordinates {(8,0.000726)(16,0.000629)(32,0.0006846)(64,0.000587)(128,0.0006006)(256,0.0008238)(512,0.0008242)(1024,0.0007962)(2048,0.0011592)(4096,0.0018998)(8192,0.0033244)(16384,0.0143314)};
        \label{plots:plot3}

    \addplot[color=black,mark=|,no markers,]
        coordinates {(8,0.0007126)(16,0.0007266)(32,0.0006846)(64,0.0006284)(128,0.0005868)(256,0.0006428)(512,0.0006424)(1024,0.0007822)(2048,0.0011172)(4096,0.0019556)(8192,0.0033108)(16384,0.0125434)};
        \label{plots:plot4}


    \nextgroupplot[
        title=\empty,
        xlabel={N},
        ylabel=\empty,
        xmin=0, xmax=16384,
        ymin=0, ymax=2.0,
        xtick={8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768},
        xticklabels={8,,,,,,,,,,,,},
        ytick={0.0,1.0,2.0,3.0},
        ymajorgrids=true,
        grid style=dashed,
        scaled x ticks=false,
        scaled y ticks=true,
        ]

    \addplot[color=blue,mark=|,no markers,]
        coordinates {(8,0.0006702)(16,0.0006286)(32,0.0007682)(64,0.000894)(128,0.0012292)(256,0.001788)(512,0.003017)(1024,0.0118454)(2048,0.0182284)(4096,0.0239416)(8192,0.0478552)(16384,0.0896062)};
        \label{plots:plot0}

    \addplot[color=red,mark=|,no markers,]
        coordinates {(8,0.0006982)(16,0.0007544)(32,0.000936)(64,0.0011592)(128,0.0018996)(256,0.0039668)(512,0.0154626)(1024,0.0253806)(2048,0.0530792)(4096,0.11697)(8192,0.252965)(16384,1.01837)};
        \label{plots:plot1}

    \addplot[color=brown,mark=|,no markers,]
        coordinates {(8,0.0006848)(16,0.000629)(32,0.0008108)(64,0.000936)(128,0.0014108)(256,0.0030868)(512,0.0130186)(1024,0.0195)(2048,0.0398376)(4096,0.0803178)(8192,0.223087)(16384,0.687657)};
        \label{plots:plot2}

    \addplot[color=green,mark=|,no markers,]
        coordinates {(8,0.0006986)(16,0.0007544)(32,0.0007686)(64,0.0009356)(128,0.001327)(256,0.0021232)(512,0.0036736)(1024,0.0127114)(2048,0.0208966)(4096,0.032965)(8192,0.0582198)(16384,0.108394)};
        \label{plots:plot3}

    \addplot[color=black,mark=|,no markers,]
        coordinates {(8,0.0006568)(16,0.0007128)(32,0.0007964)(64,0.0009358)(128,0.0011878)(256,0.0018158)(512,0.0030174)(1024,0.0118728)(2048,0.0181868)(4096,0.0266236)(8192,0.0479668)(16384,0.0889918)};
        \label{plots:plot4}

    \coordinate (bot) at (rel axis cs:1,0);% coordinate at bottom of the last plot

    \end{groupplot}

    \path (myplot c1r1.outer north west)% plot in column 1 row 1
          -- node[anchor=south,rotate=90] {Time [milliseconds]}% label midway
          (myplot c1r3.outer south west);% plot in column 1 row 3

    % legend
    \path (myplot c1r3.south west|-current bounding box.south)--
      coordinate(legendpos)
      (myplot c2r3.south east|-current bounding box.south);
    \matrix[
        matrix of nodes,
        anchor=south,
        draw,
        inner sep=0.2em,
        draw
      ]at([yshift=-5ex]legendpos)
      {
        \ref{plots:plot0}& Boost.FlatMap&[5pt]
        \ref{plots:plot1}& std::map&[5pt]
        \ref{plots:plot2}& std::unordered\_map&[5pt]
        \ref{plots:plot3}& std::vector&[5pt]
        \ref{plots:plot4}& std::vector (custom pair)&[5pt]\\
      };

\end{tikzpicture}
\\
\\


For all variants but \code{map} and \code{unordered_map}, iteration is
relatively similar, and much faster than \code{map}'s.

\begin{tikzpicture}
    \begin{groupplot}[group style={group size=2 by 3, group name=myplot}, width=3.25in]


    \nextgroupplot[
        title={<int, int> Elements},
        xlabel=\empty,
        ylabel={Windows/MSVC 2015},
        xmin=0, xmax=262144,
        ymin=0, ymax=100.0,
        xtick={8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768,65536,131072,262144,524288},
        xticklabels={8,,,,,,,,,,,,,,128k,256k,512k},
        ytick={0.0,10.0,20.0,30.0,40.0,50.0,60.0,70.0,80.0,90.0,100.0,110.0},
        ymajorgrids=true,
        grid style=dashed,
        scaled x ticks=false,
        scaled y ticks=true,
        ]

    \addplot[color=blue,mark=|,no markers,]
        coordinates {(8,0.0005412)(16,0.0008412)(32,0.002224)(64,0.0054688)(128,0.0102168)(256,0.0222946)(512,0.0460896)(1024,0.096454)(2048,0.197886)(4096,0.416388)(8192,0.902735)(16384,1.97101)(32768,4.70278)(65536,10.7202)(131072,26.1432)(262144,58.1358)};
        \label{plots:plot0}

    \addplot[color=red,mark=|,no markers,]
        coordinates {(8,0.000481)(16,0.0010814)(32,0.0022836)(64,0.004326)(128,0.008954)(256,0.0337118)(512,0.0424848)(1024,0.0918238)(2048,0.207265)(4096,0.477749)(8192,1.30968)(16384,2.72267)(32768,6.00409)(65536,13.9543)(131072,34.5729)(262144,90.7993)};
        \label{plots:plot1}

    \addplot[color=brown,mark=|,no markers,]
        coordinates {(8,0.0004806)(16,0.0008412)(32,0.0013822)(64,0.003185)(128,0.0060096)(256,0.0106362)(512,0.0253024)(1024,0.0527006)(2048,0.0992136)(4096,0.286891)(8192,0.448)(16384,1.20836)(32768,2.20905)(65536,4.39136)(131072,9.69994)(262144,23.4499)};
        \label{plots:plot2}

    \addplot[color=green,mark=|,no markers,]
        coordinates {(8,0.000541)(16,0.0009614)(32,0.0025844)(64,0.0053478)(128,0.0111778)(256,0.0243382)(512,0.0484964)(1024,0.125538)(2048,0.261466)(4096,0.490429)(8192,1.0499)(16384,2.62707)(32768,4.887)(65536,11.6276)(131072,28.1357)(262144,61.1479)};
        \label{plots:plot3}

    \addplot[color=black,mark=|,no markers,]
        coordinates {(8,0.000481)(16,0.0010214)(32,0.002224)(64,0.0052886)(128,0.0146636)(256,0.0275218)(512,0.0623174)(1024,0.106727)(2048,0.259184)(4096,0.491751)(8192,1.29846)(16384,2.3121)(32768,4.90067)(65536,11.6013)(131072,26.579)(262144,61.0952)};
        \label{plots:plot4}

    \coordinate (top) at (rel axis cs:0,1);% coordinate at top of the first plot


    \nextgroupplot[
        title={<string, string> Elements},
        xlabel=\empty,
        ylabel=\empty,
        xmin=0, xmax=262144,
        ymin=0, ymax=200.0,
        xtick={8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768,65536,131072,262144,524288},
        xticklabels={8,,,,,,,,,,,,,,128k,256k,512k},
        ytick={0.0,100.0,200.0,300.0},
        ymajorgrids=true,
        grid style=dashed,
        scaled x ticks=false,
        scaled y ticks=true,
        ]

    \addplot[color=blue,mark=|,no markers,]
        coordinates {(8,0.0003604)(16,0.002043)(32,0.0031842)(64,0.00667)(128,0.0124398)(256,0.028905)(512,0.0628)(1024,0.145728)(2048,0.327452)(4096,0.734536)(8192,1.75895)(16384,3.92775)(32768,8.87618)(65536,19.5561)(131072,46.4218)(262144,97.8965)};
        \label{plots:plot0}

    \addplot[color=red,mark=|,no markers,]
        coordinates {(8,0.0010814)(16,0.001924)(32,0.0029446)(64,0.0087738)(128,0.0115978)(256,0.0273422)(512,0.0612924)(1024,0.23881)(2048,0.310203)(4096,0.66801)(8192,1.75709)(16384,3.98783)(32768,9.15727)(65536,20.7585)(131072,54.7061)(262144,126.507)};
        \label{plots:plot1}

    \addplot[color=brown,mark=|,no markers,]
        coordinates {(8,0.0004806)(16,0.001202)(32,0.0016226)(64,0.0118388)(128,0.0071506)(256,0.0147236)(512,0.0315484)(1024,0.0644804)(2048,0.132508)(4096,0.281355)(8192,0.637178)(16384,1.4149)(32768,2.9907)(65536,6.27602)(131072,14.7029)(262144,31.2762)};
        \label{plots:plot2}

    \addplot[color=green,mark=|,no markers,]
        coordinates {(8,0.0007816)(16,0.0024638)(32,0.0034848)(64,0.011899)(128,0.0175484)(256,0.0627986)(512,0.12205)(1024,0.184308)(2048,0.40798)(4096,0.971668)(8192,2.1168)(16384,4.70469)(32768,10.0948)(65536,25.3988)(131072,57.1932)(262144,120.461)};
        \label{plots:plot3}

    \addplot[color=black,mark=|,no markers,]
        coordinates {(8,0.0005412)(16,0.0013826)(32,0.0034252)(64,0.0070902)(128,0.0149056)(256,0.0362922)(512,0.0732556)(1024,0.174573)(2048,0.371678)(4096,0.821062)(8192,1.97042)(16384,4.46821)(32768,9.64157)(65536,24.5525)(131072,56.8731)(262144,116.821)};
        \label{plots:plot4}


    \nextgroupplot[
        title=\empty,
        xlabel=\empty,
        ylabel={Linux/Clang 3.8},
        xmin=0, xmax=16384,
        ymin=0, ymax=20.0,
        xtick={8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768},
        xticklabels={8,,,,,,,,,,,,},
        ytick={0.0,10.0,20.0,30.0},
        ymajorgrids=true,
        grid style=dashed,
        scaled x ticks=false,
        scaled y ticks=true,
        ]

    \addplot[color=blue,mark=|,no markers,]
        coordinates {(8,0.0045684)(16,0.009261)(32,0.0185636)(64,0.0364568)(128,0.0727736)(256,0.145214)(512,0.294953)(1024,0.670224)(2048,1.21372)(4096,2.69158)(8192,5.34482)(16384,10.7908)};
        \label{plots:plot0}

    \addplot[color=red,mark=|,no markers,]
        coordinates {(8,0.004791)(16,0.0094986)(32,0.0182292)(64,0.0362332)(128,0.0723266)(256,0.168162)(512,0.307345)(1024,0.649194)(2048,1.34085)(4096,2.64103)(8192,5.24566)(16384,10.5011)};
        \label{plots:plot1}

    \addplot[color=brown,mark=|,no markers,]
        coordinates {(8,0.004847)(16,0.0093304)(32,0.0185636)(64,0.0365974)(128,0.0730386)(256,0.170739)(512,0.306159)(1024,0.629188)(2048,1.3664)(4096,2.64284)(8192,5.34609)(16384,10.6568)};
        \label{plots:plot2}

    \addplot[color=green,mark=|,no markers,]
        coordinates {(8,0.004764)(16,0.0092608)(32,0.0186476)(64,0.0364574)(128,0.0729982)(256,0.146875)(512,0.291323)(1024,0.65853)(2048,1.38623)(4096,2.77532)(8192,5.62783)(16384,11.3591)};
        \label{plots:plot3}

    \addplot[color=black,mark=|,no markers,]
        coordinates {(8,0.004791)(16,0.0093034)(32,0.0187314)(64,0.0364576)(128,0.0724796)(256,0.147311)(512,0.342309)(1024,0.658059)(2048,1.39248)(4096,2.75871)(8192,5.58827)(16384,11.4489)};
        \label{plots:plot4}


    \nextgroupplot[
        title=\empty,
        xlabel=\empty,
        ylabel=\empty,
        xmin=0, xmax=16384,
        ymin=0, ymax=30.0,
        xtick={8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768},
        xticklabels={8,,,,,,,,,,,,},
        ytick={0.0,10.0,20.0,30.0,40.0},
        ymajorgrids=true,
        grid style=dashed,
        scaled x ticks=false,
        scaled y ticks=true,
        ]

    \addplot[color=blue,mark=|,no markers,]
        coordinates {(8,0.0061464)(16,0.0119716)(32,0.0244036)(64,0.0504678)(128,0.105011)(256,0.219047)(512,0.474529)(1024,1.01147)(2048,2.13661)(4096,4.4922)(8192,9.68324)(16384,20.8416)};
        \label{plots:plot0}

    \addplot[color=red,mark=|,no markers,]
        coordinates {(8,0.0058536)(16,0.0117338)(32,0.0273786)(64,0.0494482)(128,0.105715)(256,0.213934)(512,0.458649)(1024,1.00129)(2048,1.84223)(4096,4.51588)(8192,9.77394)(16384,21.0322)};
        \label{plots:plot1}

    \addplot[color=brown,mark=|,no markers,]
        coordinates {(8,0.00637)(16,0.0153104)(32,0.0244864)(64,0.0483726)(128,0.0983098)(256,0.196183)(512,0.393735)(1024,0.817702)(2048,1.63992)(4096,3.33094)(8192,6.84211)(16384,13.7317)};
        \label{plots:plot2}

    \addplot[color=green,mark=|,no markers,]
        coordinates {(8,0.006258)(16,0.0126272)(32,0.025953)(64,0.0531624)(128,0.110209)(256,0.232448)(512,0.492662)(1024,1.0721)(2048,2.24478)(4096,4.73298)(8192,10.1934)(16384,22.1073)};
        \label{plots:plot3}

    \addplot[color=black,mark=|,no markers,]
        coordinates {(8,0.0064392)(16,0.0125848)(32,0.0258828)(64,0.0523674)(128,0.111665)(256,0.230023)(512,0.501116)(1024,1.06141)(2048,2.21907)(4096,4.66396)(8192,10.06)(16384,21.778)};
        \label{plots:plot4}


    \nextgroupplot[
        title=\empty,
        xlabel={N},
        ylabel={Linux/GCC 4.8.4},
        xmin=0, xmax=16384,
        ymin=0, ymax=10.0,
        xtick={8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768},
        xticklabels={8,,,,,,,,,,,,},
        ytick={0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0},
        ymajorgrids=true,
        grid style=dashed,
        scaled x ticks=false,
        scaled y ticks=true,
        ]

    \addplot[color=blue,mark=|,no markers,]
        coordinates {(8,0.005155)(16,0.0098758)(32,0.0198628)(64,0.0372808)(128,0.0729014)(256,0.147016)(512,0.287744)(1024,0.581121)(2048,1.18185)(4096,2.32339)(8192,4.67232)(16384,9.34326)};
        \label{plots:plot0}

    \addplot[color=red,mark=|,no markers,]
        coordinates {(8,0.0051404)(16,0.010141)(32,0.018522)(64,0.0371274)(128,0.0728466)(256,0.14421)(512,0.28737)(1024,0.576266)(2048,1.16553)(4096,2.32502)(8192,4.6339)(16384,9.27307)};
        \label{plots:plot1}

    \addplot[color=brown,mark=|,no markers,]
        coordinates {(8,0.005266)(16,0.0101128)(32,0.0186622)(64,0.037421)(128,0.0733336)(256,0.150844)(512,0.292342)(1024,0.579372)(2048,1.17284)(4096,2.32042)(8192,4.61489)(16384,9.28903)};
        \label{plots:plot2}

    \addplot[color=green,mark=|,no markers,]
        coordinates {(8,0.0052378)(16,0.0101974)(32,0.0184656)(64,0.0376728)(128,0.0731106)(256,0.148385)(512,0.287394)(1024,0.588945)(2048,1.20434)(4096,2.33993)(8192,4.70186)(16384,9.3825)};
        \label{plots:plot3}

    \addplot[color=black,mark=|,no markers,]
        coordinates {(8,0.0051544)(16,0.0100716)(32,0.0185492)(64,0.0374358)(128,0.0727044)(256,0.144363)(512,0.290891)(1024,0.580702)(2048,1.16753)(4096,2.34962)(8192,4.67139)(16384,9.38233)};
        \label{plots:plot4}


    \nextgroupplot[
        title=\empty,
        xlabel={N},
        ylabel=\empty,
        xmin=0, xmax=16384,
        ymin=0, ymax=20.0,
        xtick={8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768},
        xticklabels={8,,,,,,,,,,,,},
        ytick={0.0,10.0,20.0,30.0},
        ymajorgrids=true,
        grid style=dashed,
        scaled x ticks=false,
        scaled y ticks=true,
        ]

    \addplot[color=blue,mark=|,no markers,]
        coordinates {(8,0.0049162)(16,0.009847)(32,0.0194726)(64,0.0389404)(128,0.0794314)(256,0.16408)(512,0.340181)(1024,0.70777)(2048,1.44916)(4096,3.05267)(8192,6.52436)(16384,14.1962)};
        \label{plots:plot0}

    \addplot[color=red,mark=|,no markers,]
        coordinates {(8,0.0047908)(16,0.0098892)(32,0.0191372)(64,0.038582)(128,0.0783966)(256,0.163255)(512,0.336729)(1024,0.705795)(2048,1.46342)(4096,3.09174)(8192,6.51279)(16384,14.6249)};
        \label{plots:plot1}

    \addplot[color=brown,mark=|,no markers,]
        coordinates {(8,0.0047214)(16,0.0094002)(32,0.018158)(64,0.0367792)(128,0.0730412)(256,0.146036)(512,0.292859)(1024,0.585271)(2048,1.1712)(4096,2.34171)(8192,4.69376)(16384,9.38989)};
        \label{plots:plot2}

    \addplot[color=green,mark=|,no markers,]
        coordinates {(8,0.005001)(16,0.0098196)(32,0.0196528)(64,0.0401068)(128,0.0808782)(256,0.166377)(512,0.344639)(1024,0.719281)(2048,1.49419)(4096,3.1028)(8192,6.65632)(16384,14.4204)};
        \label{plots:plot3}

    \addplot[color=black,mark=|,no markers,]
        coordinates {(8,0.0049582)(16,0.0098196)(32,0.0196408)(64,0.0394638)(128,0.080106)(256,0.164841)(512,0.341456)(1024,0.728442)(2048,1.45667)(4096,3.06873)(8192,6.55384)(16384,14.2833)};
        \label{plots:plot4}

    \coordinate (bot) at (rel axis cs:1,0);% coordinate at bottom of the last plot

    \end{groupplot}

    \path (myplot c1r1.outer north west)% plot in column 1 row 1
          -- node[anchor=south,rotate=90] {Time [milliseconds]}% label midway
          (myplot c1r3.outer south west);% plot in column 1 row 3

    % legend
    \path (myplot c1r3.south west|-current bounding box.south)--
      coordinate(legendpos)
      (myplot c2r3.south east|-current bounding box.south);
    \matrix[
        matrix of nodes,
        anchor=south,
        draw,
        inner sep=0.2em,
        draw
      ]at([yshift=-5ex]legendpos)
      {
        \ref{plots:plot0}& Boost.FlatMap&[5pt]
        \ref{plots:plot1}& std::map&[5pt]
        \ref{plots:plot2}& std::unordered\_map&[5pt]
        \ref{plots:plot3}& std::vector&[5pt]
        \ref{plots:plot4}& std::vector (custom pair)&[5pt]\\
      };

\end{tikzpicture}
\\
\\


\code{find()} performance is where things get interesting.  The different
platforms produce strikingly different results.\\

In the MSVC runs, there is a large differentiation between Boost.FlatMap and
\code{map}; in fact, Boost.FlatMap even beats both the sorted \code{vector}
variants.  Also, \code{unordered_map} is the clear winner, regardless of
valkue type.\\

GCC and Clang on Linux produce nearly identical results.  For \code{<int,
  int>} runs, all implementations are nearly identical.  \code{unordered_map}
is faster in the \code{<std::string, std::string>} runs, but all other
variants are very close.

\begin{tikzpicture}
    \begin{groupplot}[group style={group size=2 by 3, group name=myplot}, width=3.25in]


    \nextgroupplot[
        title={<int, int> Elements},
        xlabel=\empty,
        ylabel={Windows/MSVC 2015},
        xmin=0, xmax=262144,
        ymin=0, ymax=20000.0,
        xtick={8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768,65536,131072,262144,524288},
        xticklabels={8,,,,,,,,,,,,,,128k,256k,512k},
        ytick={0.0,10000.0,20000.0,30000.0},
        ymajorgrids=true,
        grid style=dashed,
        scaled x ticks=false,
        scaled y ticks=true,
        ]

    \addplot[color=blue,mark=|,no markers,]
        coordinates {(8,0.0005412)(16,0.0012622)(32,0.0022236)(64,0.0048684)(128,0.013822)(256,0.0524028)(512,0.0844336)(1024,0.245183)(2048,0.780022)(4096,2.92699)(8192,12.4929)(16384,41.2259)(32768,169.688)(65536,666.604)(131072,2707.74)(262144,10794.1)};
        \label{plots:plot0}

    \addplot[color=red,mark=|,no markers,]
        coordinates {(8,0.0007814)(16,0.0022832)(32,0.0046274)(64,0.0075716)(128,0.015023)(256,0.0563082)(512,0.0808866)(1024,0.179922)(2048,0.419096)(4096,0.918167)(8192,2.04777)(16384,4.87199)(32768,9.96307)(65536,23.152)(131072,52.4436)(262144,125.452)};
        \label{plots:plot1}

    \addplot[color=brown,mark=|,no markers,]
        coordinates {(8,0.000601)(16,0.0013826)(32,0.002704)(64,0.0060698)(128,0.010757)(256,0.0225954)(512,0.0450096)(1024,0.094225)(2048,0.200893)(4096,0.646908)(8192,0.791973)(16384,1.8269)(32768,4.04761)(65536,7.92921)(131072,17.0191)(262144,39.8519)};
        \label{plots:plot2}

    \addplot[color=green,mark=|,no markers,]
        coordinates {(8,0.0003004)(16,0.0011416)(32,0.0018032)(64,0.0054088)(128,0.011898)(256,0.0296878)(512,0.139716)(1024,0.250167)(2048,0.956997)(4096,2.84359)(8192,12.095)(16384,42.5979)(32768,166.84)(65536,666.385)(131072,2689.86)(262144,10687.3)};
        \label{plots:plot3}

    \addplot[color=black,mark=|,no markers,]
        coordinates {(8,0.0005408)(16,0.0009016)(32,0.002043)(64,0.0052286)(128,0.0122586)(256,0.0249996)(512,0.071512)(1024,0.132208)(2048,0.350465)(4096,0.916976)(8192,3.53592)(16384,10.431)(32768,42.0172)(65536,181.331)(131072,790.418)(262144,3407.34)};
        \label{plots:plot4}

    \coordinate (top) at (rel axis cs:0,1);% coordinate at top of the first plot


    \nextgroupplot[
        title={<string, string> Elements},
        xlabel=\empty,
        ylabel=\empty,
        xmin=0, xmax=262144,
        ymin=0, ymax=300000.0,
        xtick={8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768,65536,131072,262144,524288},
        xticklabels={8,,,,,,,,,,,,,,128k,256k,512k},
        ytick={0.0,100000.0,200000.0,300000.0,400000.0},
        ymajorgrids=true,
        grid style=dashed,
        scaled x ticks=false,
        scaled y ticks=true,
        ]

    \addplot[color=blue,mark=|,no markers,]
        coordinates {(8,0.0008414)(16,0.0054088)(32,0.006911)(64,0.0347944)(128,0.062559)(256,0.240439)(512,0.854535)(1024,3.26682)(2048,13.5974)(4096,52.9047)(8192,215.65)(16384,831.651)(32768,3398.2)(65536,13603.8)(131072,53887.9)(262144,212074)};
        \label{plots:plot0}

    \addplot[color=red,mark=|,no markers,]
        coordinates {(8,0.0007812)(16,0.0099758)(32,0.004447)(64,0.0137022)(128,0.0234364)(256,0.0566686)(512,0.12674)(1024,0.426427)(2048,0.629198)(4096,1.39412)(8192,3.33587)(16384,7.4501)(32768,16.6817)(65536,36.7056)(131072,88.8893)(262144,196.428)};
        \label{plots:plot1}

    \addplot[color=brown,mark=|,no markers,]
        coordinates {(8,0.0011418)(16,0.0025844)(32,0.0034854)(64,0.0100954)(128,0.0128608)(256,0.0263222)(512,0.0540828)(1024,0.114414)(2048,0.237606)(4096,0.509841)(8192,1.1538)(16384,2.38643)(32768,4.82195)(65536,9.74715)(131072,21.2185)(262144,44.6223)};
        \label{plots:plot2}

    \addplot[color=green,mark=|,no markers,]
        coordinates {(8,0.001322)(16,0.0045074)(32,0.006971)(64,0.0418868)(128,0.0664626)(256,0.429909)(512,1.07905)(1024,3.38142)(2048,13.0411)(4096,54.3742)(8192,214.665)(16384,862.112)(32768,3428.92)(65536,13781.6)(131072,54551.7)(262144,214559)};
        \label{plots:plot3}

    \addplot[color=black,mark=|,no markers,]
        coordinates {(8,0.0008414)(16,0.0029446)(32,0.0063708)(64,0.021934)(128,0.0646018)(256,0.239233)(512,0.923944)(1024,3.45131)(2048,13.0642)(4096,52.1599)(8192,212.11)(16384,863.064)(32768,3419)(65536,13756.1)(131072,54658.3)(262144,213636)};
        \label{plots:plot4}


    \nextgroupplot[
        title=\empty,
        xlabel=\empty,
        ylabel={Linux/Clang 3.8},
        xmin=0, xmax=16384,
        ymin=0, ymax=200.0,
        xtick={8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768},
        xticklabels={8,,,,,,,,,,,,},
        ytick={0.0,100.0,200.0,300.0},
        ymajorgrids=true,
        grid style=dashed,
        scaled x ticks=false,
        scaled y ticks=true,
        ]

    \addplot[color=blue,mark=|,no markers,]
        coordinates {(8,0.0048192)(16,0.0094292)(32,0.0187454)(64,0.0376436)(128,0.0752052)(256,0.170874)(512,0.3487)(1024,0.925614)(2048,2.09986)(4096,11.8845)(8192,52.9383)(16384,165.34)};
        \label{plots:plot0}

    \addplot[color=red,mark=|,no markers,]
        coordinates {(8,0.0047492)(16,0.0098746)(32,0.0201284)(64,0.0372242)(128,0.0742704)(256,0.19966)(512,0.407764)(1024,0.634273)(2048,1.48961)(4096,2.90778)(8192,5.82129)(16384,11.9717)};
        \label{plots:plot1}

    \addplot[color=brown,mark=|,no markers,]
        coordinates {(8,0.0053918)(16,0.0100434)(32,0.0195972)(64,0.038469)(128,0.0769516)(256,0.189253)(512,0.309525)(1024,0.770039)(2048,1.52985)(4096,3.02348)(8192,6.11208)(16384,12.2942)};
        \label{plots:plot2}

    \addplot[color=green,mark=|,no markers,]
        coordinates {(8,0.0048614)(16,0.009513)(32,0.018591)(64,0.0372674)(128,0.0786696)(256,0.158554)(512,0.331421)(1024,0.866333)(2048,3.17126)(4096,11.7611)(8192,52.8485)(16384,197.95)};
        \label{plots:plot3}

    \addplot[color=black,mark=|,no markers,]
        coordinates {(8,0.0048192)(16,0.0095264)(32,0.0185778)(64,0.0369334)(128,0.0732796)(256,0.152772)(512,0.410979)(1024,0.638711)(2048,1.87509)(4096,4.61748)(8192,15.591)(16384,81.4043)};
        \label{plots:plot4}


    \nextgroupplot[
        title=\empty,
        xlabel=\empty,
        ylabel=\empty,
        xmin=0, xmax=16384,
        ymin=0, ymax=2000.0,
        xtick={8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768},
        xticklabels={8,,,,,,,,,,,,},
        ytick={0.0,1000.0,2000.0,3000.0},
        ymajorgrids=true,
        grid style=dashed,
        scaled x ticks=false,
        scaled y ticks=true,
        ]

    \addplot[color=blue,mark=|,no markers,]
        coordinates {(8,0.0065926)(16,0.0139686)(32,0.030814)(64,0.080904)(128,0.208056)(256,0.723139)(512,3.32461)(1024,11.7122)(2048,22.3965)(4096,134.409)(8192,486.86)(16384,1822.09)};
        \label{plots:plot0}

    \addplot[color=red,mark=|,no markers,]
        coordinates {(8,0.0062018)(16,0.0120408)(32,0.0245832)(64,0.0513184)(128,0.10919)(256,0.230895)(512,0.520242)(1024,1.13297)(2048,2.29887)(4096,4.78837)(8192,10.2731)(16384,22.3226)};
        \label{plots:plot1}

    \addplot[color=brown,mark=|,no markers,]
        coordinates {(8,0.0069556)(16,0.0139266)(32,0.0278104)(64,0.055762)(128,0.111299)(256,0.236511)(512,0.456583)(1024,0.956253)(2048,1.85407)(4096,3.67611)(8192,7.81764)(16384,15.8978)};
        \label{plots:plot2}

    \addplot[color=green,mark=|,no markers,]
        coordinates {(8,0.006579)(16,0.014038)(32,0.0316654)(64,0.078892)(128,0.27051)(256,0.726681)(512,3.31104)(1024,11.6991)(2048,39.039)(4096,134.321)(8192,486.848)(16384,1826.08)};
        \label{plots:plot3}

    \addplot[color=black,mark=|,no markers,]
        coordinates {(8,0.0066352)(16,0.0138992)(32,0.030871)(64,0.0782216)(128,0.210083)(256,0.707966)(512,3.34642)(1024,11.6513)(2048,39.0619)(4096,134.42)(8192,485.219)(16384,1823.61)};
        \label{plots:plot4}


    \nextgroupplot[
        title=\empty,
        xlabel={N},
        ylabel={Linux/GCC 4.8.4},
        xmin=0, xmax=16384,
        ymin=0, ymax=80.0,
        xtick={8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768},
        xticklabels={8,,,,,,,,,,,,},
        ytick={0.0,10.0,20.0,30.0,40.0,50.0,60.0,70.0,80.0,90.0},
        ymajorgrids=true,
        grid style=dashed,
        scaled x ticks=false,
        scaled y ticks=true,
        ]

    \addplot[color=blue,mark=|,no markers,]
        coordinates {(8,0.0051684)(16,0.0100988)(32,0.0189688)(64,0.0381186)(128,0.0758052)(256,0.156347)(512,0.333535)(1024,0.744523)(2048,1.81553)(4096,4.86591)(8192,15.731)(16384,77.9346)};
        \label{plots:plot0}

    \addplot[color=red,mark=|,no markers,]
        coordinates {(8,0.0056428)(16,0.0108672)(32,0.0196952)(64,0.0389858)(128,0.0756944)(256,0.153175)(512,0.301431)(1024,0.615718)(2048,1.24836)(4096,2.47892)(8192,4.99536)(16384,10.2227)};
        \label{plots:plot1}

    \addplot[color=brown,mark=|,no markers,]
        coordinates {(8,0.0069282)(16,0.0104484)(32,0.019375)(64,0.038595)(128,0.0752062)(256,0.149309)(512,0.291811)(1024,0.591289)(2048,1.18659)(4096,2.35797)(8192,4.718)(16384,9.51694)};
        \label{plots:plot2}

    \addplot[color=green,mark=|,no markers,]
        coordinates {(8,0.005085)(16,0.0100704)(32,0.0190798)(64,0.0385254)(128,0.0756112)(256,0.154488)(512,0.330023)(1024,0.74344)(2048,1.81547)(4096,4.87871)(8192,15.683)(16384,77.3447)};
        \label{plots:plot3}

    \addplot[color=black,mark=|,no markers,]
        coordinates {(8,0.0051126)(16,0.0100714)(32,0.0189274)(64,0.0374906)(128,0.0739058)(256,0.149056)(512,0.303459)(1024,0.631182)(2048,1.36308)(4096,3.02529)(8192,7.94798)(16384,24.6787)};
        \label{plots:plot4}


    \nextgroupplot[
        title=\empty,
        xlabel={N},
        ylabel=\empty,
        xmin=0, xmax=16384,
        ymin=0, ymax=600.0,
        xtick={8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768},
        xticklabels={8,,,,,,,,,,,,},
        ytick={0.0,100.0,200.0,300.0,400.0,500.0,600.0,700.0},
        ymajorgrids=true,
        grid style=dashed,
        scaled x ticks=false,
        scaled y ticks=true,
        ]

    \addplot[color=blue,mark=|,no markers,]
        coordinates {(8,0.0049582)(16,0.0100994)(32,0.0213012)(64,0.046331)(128,0.10264)(256,0.252517)(512,0.670441)(1024,2.04984)(2048,9.59907)(4096,38.1017)(8192,135.417)(16384,500.412)};
        \label{plots:plot0}

    \addplot[color=red,mark=|,no markers,]
        coordinates {(8,0.0052106)(16,0.0103918)(32,0.0205288)(64,0.0422002)(128,0.0866408)(256,0.180538)(512,0.375797)(1024,0.789487)(2048,1.62409)(4096,3.35192)(8192,7.08697)(16384,15.3573)};
        \label{plots:plot1}

    \addplot[color=brown,mark=|,no markers,]
        coordinates {(8,0.0050568)(16,0.0098624)(32,0.0193746)(64,0.0389594)(128,0.0768664)(256,0.15428)(512,0.31564)(1024,0.616745)(2048,1.243)(4096,2.49239)(8192,5.01825)(16384,10.1566)};
        \label{plots:plot2}

    \addplot[color=green,mark=|,no markers,]
        coordinates {(8,0.0053354)(16,0.010365)(32,0.0229774)(64,0.0462372)(128,0.103739)(256,0.259173)(512,0.710587)(1024,2.40604)(2048,11.2079)(4096,43.2541)(8192,146.819)(16384,523.179)};
        \label{plots:plot3}

    \addplot[color=black,mark=|,no markers,]
        coordinates {(8,0.0051558)(16,0.0102964)(32,0.021274)(64,0.045104)(128,0.09987)(256,0.24391)(512,0.651965)(1024,2.00616)(2048,9.4564)(4096,37.7574)(8192,134.736)(16384,496.093)};
        \label{plots:plot4}

    \coordinate (bot) at (rel axis cs:1,0);% coordinate at bottom of the last plot

    \end{groupplot}

    \path (myplot c1r1.outer north west)% plot in column 1 row 1
          -- node[anchor=south,rotate=90] {Time [milliseconds]}% label midway
          (myplot c1r3.outer south west);% plot in column 1 row 3

    % legend
    \path (myplot c1r3.south west|-current bounding box.south)--
      coordinate(legendpos)
      (myplot c2r3.south east|-current bounding box.south);
    \matrix[
        matrix of nodes,
        anchor=south,
        draw,
        inner sep=0.2em,
        draw
      ]at([yshift=-5ex]legendpos)
      {
        \ref{plots:plot0}& Boost.FlatMap&[5pt]
        \ref{plots:plot1}& std::map&[5pt]
        \ref{plots:plot2}& std::unordered\_map&[5pt]
        \ref{plots:plot3}& std::vector&[5pt]
        \ref{plots:plot4}& std::vector (custom pair)&[5pt]\\
      };

\end{tikzpicture}
\\
\\


Erasure has a nearly identical performance profile to insertion.\\


\subsection{Implications}

Iteration is vastly cheaper for contiguous-storage variants.  Any node-based
associative container will always be slower than a flattened one for
iteration.  For use cases where there is a lot of iteration, this can be the
deciding runtime performance consideration.\\

In all the graphs above, the reason the custom-\code{pair} sorted vector
performs so much better than \code{vector<pair<int, int>>} seems to be that
the custom-\code{pair} type has \code{nothrow} special functions.
Implementing all the special functions and adding \code{nothrow(false)} to
each makes the custom-\code{pair} version perform identically to the
\code{pair<int, int>} version.\\

Boost.FlatMap differs significantly from a sorted \code{vector}.  Clearly
there are a lot of QOI choices that affect the runtime performance of a
standard \code{flat_map}.\\

The fact that insertion and erasure operations produce such similar results
implies that pre-\code{reserve()}ing space will probably not make much
difference when using a flat map.\\

Use cases in which the runtime performance of a flat map would be no better
than \code{map} or \code{unordered_map}, the user may still decide to use a
flat implementation for the storage savings.
